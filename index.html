â€<!DOCTYPE html>
â€<html lang="ar" dir="rtl">
â€<head>
â€Â Â Â  <meta charset="UTF-8">
â€Â Â Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
â€Â Â Â  <title>Ù…Ù†ØµØ© Ù…ÙˆØ§Ø¯ÙÙƒ | Ø§Ù„ØªØ·ÙˆÙŠØ± Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ</title>
â€Â Â Â  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap" rel="stylesheet">
â€Â Â Â  
â€Â Â Â  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
â€Â Â Â  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
â€
â€Â Â Â  <style>
â€Â Â Â Â Â Â Â  :root {
â€Â Â Â Â Â Â Â Â Â Â Â  --primary: #0e3d59; --accent: #d4af37; --bg: #f8fafb;
â€Â Â Â Â Â Â Â Â Â Â Â  --white: #ffffff; --green: #2ecc71; --red: #e74c3c;
â€Â Â Â Â Â Â Â Â Â Â Â  --text: #2c3e50; --shadow: 0 4px 12px rgba(0,0,0,0.08);
â€Â Â Â Â Â Â Â  }
â€Â Â Â Â Â Â Â  body { font-family: 'Cairo', sans-serif; background: var(--bg); margin: 0; padding-bottom: 80px; direction: rtl; }
â€Â Â Â Â Â Â Â  
â€Â Â Â Â Â Â Â  header { 
â€Â Â Â Â Â Â Â Â Â Â Â  background: var(--primary); color: white; padding: 15px; text-align: center; 
â€Â Â Â Â Â Â Â Â Â Â Â  border-bottom: 4px solid var(--accent); position: sticky; top: 0; z-index: 1000;
â€Â Â Â Â Â Â Â  }
â€Â Â Â Â Â Â Â  .eng-section { background: #111; color: var(--accent); margin: 10px; padding: 10px; border-radius: 8px; text-align: center; font-size: 14px; font-weight: bold; }
â€
â€Â Â Â Â Â Â Â  .tabs-container { 
â€Â Â Â Â Â Â Â Â Â Â Â  display: flex; overflow-x: auto; background: white; padding: 12px; gap: 8px; 
â€Â Â Â Â Â Â Â Â Â Â Â  box-shadow: var(--shadow); position: sticky; top: 65px; z-index: 999;
â€Â Â Â Â Â Â Â  }
â€Â Â Â Â Â Â Â  .tabs-container::-webkit-scrollbar { display: none; }
â€Â Â Â Â Â Â Â  .tab-btn { 
â€Â Â Â Â Â Â Â Â Â Â Â  background: #f0f2f5; border: none; padding: 8px 18px; border-radius: 20px; 
â€Â Â Â Â Â Â Â Â Â Â Â  font-family: 'Cairo'; font-size: 12px; font-weight: bold; white-space: nowrap; cursor: pointer; 
â€Â Â Â Â Â Â Â  }
â€Â Â Â Â Â Â Â  .tab-btn.active { background: var(--primary); color: white; }
â€
â€Â Â Â Â Â Â Â  .view-section { display: none; padding: 15px; animation: fadeIn 0.3s; }
â€Â Â Â Â Â Â Â  .view-section.active { display: block; }
â€Â Â Â Â Â Â Â  @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
â€
â€Â Â Â Â Â Â Â  .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
â€Â Â Â Â Â Â Â  .card { background: white; border-radius: 12px; overflow: hidden; box-shadow: var(--shadow); border: 1px solid #eee; position: relative; }
â€Â Â Â Â Â Â Â  .card img { width: 100%; height: 120px; object-fit: cover; background: #eee; }
â€Â Â Â Â Â Â Â  .card-body { padding: 10px; }
â€Â Â Â Â Â Â Â  .p-name { font-size: 12px; font-weight: bold; height: 35px; overflow: hidden; }
â€Â Â Â Â Â Â Â  .p-price-num { color: var(--red); font-weight: 900; font-size: 15px; display: block; }
â€Â Â Â Â Â Â Â  .p-price-text { color: #2980b9; font-size: 10px; font-weight: bold; display: block; }
â€
â€Â Â Â Â Â Â Â  .form-container { background: white; padding: 25px; border-radius: 20px; box-shadow: var(--shadow); max-width: 500px; margin: 0 auto; }
â€Â Â Â Â Â Â Â  .input-group { position: relative; margin-bottom: 15px; text-align: right; }
â€Â Â Â Â Â Â Â  .input-group label { display: block; font-size: 13px; font-weight: bold; color: var(--primary); margin-bottom: 5px; }
â€Â Â Â Â Â Â Â  
â€Â Â Â Â Â Â Â  input, select, textarea { 
â€Â Â Â Â Â Â Â Â Â Â Â  width: 100%; padding: 14px; border: 1px solid #e0e0e0; border-radius: 12px; 
â€Â Â Â Â Â Â Â Â Â Â Â  font-family: 'Cairo'; outline: none; background: #fafafa; font-size: 14px;
â€Â Â Â Â Â Â Â Â Â Â Â  transition: 0.3s; box-sizing: border-box;
â€Â Â Â Â Â Â Â  }
â€
â€Â Â Â Â Â Â Â  .upload-area { 
â€Â Â Â Â Â Â Â Â Â Â Â  border: 2px dashed #d0d7de; padding: 25px; text-align: center; border-radius: 15px; 
â€Â Â Â Â Â Â Â Â Â Â Â  cursor: pointer; background: #fdfdfd; transition: 0.3s; margin-top: 10px;
â€Â Â Â Â Â Â Â  }
â€Â Â Â Â Â Â Â  #imagePreview { width: 120px; height: 120px; object-fit: cover; margin: 15px auto 0; border-radius: 12px; border: 2px solid #eee; display: none; }
â€
â€Â Â Â Â Â Â Â  .btn-submit { 
â€Â Â Â Â Â Â Â Â Â Â Â  background: var(--green); color: white; border: none; width: 100%; padding: 16px; 
â€Â Â Â Â Â Â Â Â Â Â Â  border-radius: 12px; font-weight: 900; font-size: 16px; cursor: pointer; 
â€Â Â Â Â Â Â Â Â Â Â Â  margin-top: 20px; box-shadow: 0 4px 10px rgba(46, 204, 113, 0.3);
â€Â Â Â Â Â Â Â  }
â€
â€Â Â Â Â Â Â Â  .auth-container { background: white; padding: 25px; border-radius: 20px; box-shadow: var(--shadow); max-width: 500px; margin: 10px auto; }
â€Â Â Â Â Â Â Â  .role-selector { display: flex; gap: 5px; margin-bottom: 20px; background: #f0f2f5; padding: 5px; border-radius: 10px; }
â€Â Â Â Â Â Â Â  .role-btn { flex: 1; padding: 10px; font-size: 12px; border: none; border-radius: 8px; cursor: pointer; font-family: 'Cairo'; font-weight: bold; transition: 0.3s; }
â€Â Â Â Â Â Â Â  .role-btn.active { background: var(--primary); color: white; }
â€Â Â Â Â Â Â Â  
â€Â Â Â Â Â Â Â  .bottom-nav { position: fixed; bottom: 0; width: 100%; background: white; display: flex; justify-content: space-around; padding: 10px 0; border-top: 1px solid #eee; z-index: 2000; }
â€Â Â Â Â Â Â Â  .nav-item { text-align: center; font-size: 10px; color: #999; cursor: pointer; flex: 1; }
â€Â Â Â Â Â Â Â  .nav-item.active { color: var(--primary); font-weight: bold; }
â€Â Â Â Â Â Â Â  .nav-item span { font-size: 20px; display: block; }
â€Â Â Â Â Â Â Â  .delete-btn { position: absolute; top: 5px; left: 5px; background: var(--red); color: white; border: none; border-radius: 5px; padding: 3px 7px; font-size: 10px; cursor: pointer; z-index: 100;}
â€Â Â Â  </style>
â€</head>
â€<body>
â€
â€<header><h1>Ù…ÙˆØ§Ø¯ÙÙƒ <span>Ø§Ù„Ø¹Ø±Ø§Ù‚</span></h1></header>
â€<div class="eng-section">ğŸ“ Ù…Ù†ØµØ© Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³ÙŠÙ† ÙˆØ§Ù„Ù…ÙˆØ±Ø¯ÙŠÙ† ÙˆØ§Ù„Ø²Ø¨Ø§Ø¦Ù†</div>
â€
â€<div id="homeView" class="view-section active">
â€Â Â Â  <div class="tabs-container" id="tabsMenu">
â€Â Â Â Â Â Â Â  <button class="tab-btn active" onclick="filterData('Ø§Ù„ÙƒÙ„', this)">Ø§Ù„ÙƒÙ„</button>
â€Â Â Â Â Â Â Â  <button class="tab-btn" onclick="filterData('Ø¨Ù†Ø§Ø¡', this)">Ø¨Ù†Ø§Ø¡</button>
â€Â Â Â Â Â Â Â  <button class="tab-btn" onclick="filterData('ØªØ³Ù„ÙŠØ­', this)">ØªØ³Ù„ÙŠØ­</button>
â€Â Â Â Â Â Â Â  <button class="tab-btn" onclick="filterData('Ø³ÙŠØ±Ø§Ù…ÙŠÙƒ', this)">Ø³ÙŠØ±Ø§Ù…ÙŠÙƒ</button>
â€Â Â Â Â Â Â Â  <button class="tab-btn" onclick="filterData('ØµØ­ÙŠØ§Øª', this)">ØµØ­ÙŠØ§Øª</button>
â€Â Â Â Â Â Â Â  <button class="tab-btn" onclick="filterData('ÙƒÙ‡Ø±Ø¨Ø§Ø¡', this)">ÙƒÙ‡Ø±Ø¨Ø§Ø¡</button>
â€Â Â Â Â Â Â Â  <button class="tab-btn" onclick="filterData('Ø£ØµØ¨Ø§Øº', this)">Ø£ØµØ¨Ø§Øº</button>
â€Â Â Â Â Â Â Â  <button class="tab-btn" onclick="filterData('Ø¥Ù†Ø´Ø§Ø¦ÙŠØ©', this)">Ø¥Ù†Ø´Ø§Ø¦ÙŠØ©</button>
â€Â Â Â Â Â Â Â  <button class="tab-btn" onclick="filterData('Ù…Ø¨ÙŠØ¯Ø§Øª', this)">Ù…Ø¨ÙŠØ¯Ø§Øª</button>
â€Â Â Â Â Â Â Â  <button class="tab-btn" onclick="filterData('Ø´Ø¨Ø§Ø¨ÙŠÙƒ', this)">Ø´Ø¨Ø§Ø¨ÙŠÙƒ</button>
â€Â Â Â  </div>
â€Â Â Â  <div class="grid" id="mainGrid" style="margin-top:15px;"></div>
â€</div>
â€
â€<div id="supplierView" class="view-section">
â€Â Â Â  <div class="form-container">
â€Â Â Â Â Â Â Â  <h3 style="margin:0 0 20px; text-align: center; color: var(--primary);">ğŸ“¥ Ø¥Ø¶Ø§ÙØ© Ù…Ø§Ø¯Ø© Ø¬Ø¯ÙŠØ¯Ø© Ù„Ù„Ø³ÙˆÙ‚</h3>
â€Â Â Â Â Â Â Â  <div class="input-group">
â€Â Â Â Â Â Â Â Â Â Â Â  <label>ğŸ“¦ Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ø¯Ø©</label>
â€Â Â Â Â Â Â Â Â Â Â Â  <input type="text" id="pName" placeholder="Ù…Ø«Ø§Ù„: Ø³Ù…Ù†Øª Ù…Ù‚Ø§ÙˆÙ… Ù„Ù„Ø±Ø·ÙˆØ¨Ø©">
â€Â Â Â Â Â Â Â  </div>
â€Â Â Â Â Â Â Â  <div class="input-group">
â€Â Â Â Â Â Â Â Â Â Â Â  <label>ğŸ’° Ø§Ù„Ø³Ø¹Ø± (Ø¯ÙŠÙ†Ø§Ø± Ø¹Ø±Ø§Ù‚ÙŠ)</label>
â€Â Â Â Â Â Â Â Â Â Â Â  <input type="number" id="pPrice" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø³Ø¹Ø± Ø¨Ø§Ù„Ø£Ø±Ù‚Ø§Ù… ÙÙ‚Ø·">
â€Â Â Â Â Â Â Â  </div>
â€Â Â Â Â Â Â Â  <div class="input-group">
â€Â Â Â Â Â Â Â Â Â Â Â  <label>ğŸ“‚ ØªØµÙ†ÙŠÙ Ø§Ù„Ù…Ø§Ø¯Ø©</label>
â€Â Â Â Â Â Â Â Â Â Â Â  <select id="pCat">
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  <option>Ø¨Ù†Ø§Ø¡</option><option>ØªØ³Ù„ÙŠØ­</option><option>Ø³ÙŠØ±Ø§Ù…ÙŠÙƒ</option>
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  <option>ØµØ­ÙŠØ§Øª</option><option>ÙƒÙ‡Ø±Ø¨Ø§Ø¡</option><option>Ø£ØµØ¨Ø§Øº</option>
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  <option>Ø¥Ù†Ø´Ø§Ø¦ÙŠØ©</option><option>Ù…Ø¨ÙŠØ¯Ø§Øª</option><option>Ø´Ø¨Ø§Ø¨ÙŠÙƒ</option>
â€Â Â Â Â Â Â Â Â Â Â Â  </select>
â€Â Â Â Â Â Â Â  </div>
â€Â Â Â Â Â Â Â  <div class="upload-area" onclick="document.getElementById('pImgFile').click()">
â€Â Â Â Â Â Â Â Â Â Â Â  <span style="font-size: 24px; display: block;">ğŸ“¸</span>
â€Â Â Â Â Â Â Â Â Â Â Â  <span style="font-weight: bold; color: #555;">Ø§Ø¶ØºØ· Ù„Ø±ÙØ¹ ØµÙˆØ±Ø© Ø§Ù„Ù…Ù†ØªØ¬</span>
â€Â Â Â Â Â Â Â Â Â Â Â  <input type="file" id="pImgFile" accept="image/*" style="display:none" onchange="previewAndResizeImage(this)">
â€Â Â Â Â Â Â Â Â Â Â Â  <img id="imagePreview" src="">
â€Â Â Â Â Â Â Â  </div>
â€Â Â Â Â Â Â Â  <button class="btn-submit" id="submitBtn" onclick="addProduct()">Ù†Ø´Ø± ÙÙŠ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø¹Ø±Ø§Ù‚ÙŠ</button>
â€Â Â Â  </div>
â€Â Â Â  <h3 style="margin:30px 0 15px; border-right: 4px solid var(--accent); padding-right: 10px;">ğŸ› ï¸ Ù…ÙˆØ§Ø¯Ùƒ Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø© Ø­Ø§Ù„ÙŠØ§Ù‹</h3>
â€Â Â Â  <div class="grid" id="adminGrid"></div>
â€</div>
â€
â€<div id="authView" class="view-section">
â€Â Â Â  <div class="auth-container">
â€Â Â Â Â Â Â Â  <h3 style="margin:0 0 20px; text-align: center; color: var(--primary);">ğŸ‘¤ Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø´Ø®ØµÙŠ</h3>
â€Â Â Â Â Â Â Â  <div class="role-selector">
â€Â Â Â Â Â Â Â Â Â Â Â  <button class="role-btn active" id="role-customer" onclick="setRole('customer', this)">Ø²Ø¨ÙˆÙ†</button>
â€Â Â Â Â Â Â Â Â Â Â Â  <button class="role-btn" id="role-engineer" onclick="setRole('engineer', this)">Ù…Ù‡Ù†Ø¯Ø³</button>
â€Â Â Â Â Â Â Â Â Â Â Â  <button class="role-btn" id="role-supplier" onclick="setRole('supplier', this)">Ù…ÙˆØ±Ø¯ Ù…ÙˆØ§Ø¯</button>
â€Â Â Â Â Â Â Â  </div>
â€Â Â Â Â Â Â Â  <div class="input-group"><label>ğŸ‘¤ Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</label><input type="text" id="userName"></div>
â€Â Â Â Â Â Â Â  <div class="input-group"><label>ğŸ“ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label><input type="tel" id="userPhone"></div>
â€Â Â Â Â Â Â Â  <div class="input-group"><label>ğŸ“ Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©</label><select id="userCity"><option>Ø¨ØºØ¯Ø§Ø¯</option><option>Ø§Ù„Ø¨ØµØ±Ø©</option><option>Ø¨Ø§Ø¨Ù„</option><option>Ø§Ù„Ù†Ø¬Ù</option><option>Ù†ÙŠÙ†ÙˆÙ‰</option></select></div>
â€Â Â Â Â Â Â Â  <div class="input-group"><label>ğŸ  Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</label><textarea id="userAddress"></textarea></div>
â€Â Â Â Â Â Â Â  <div id="businessDetails" style="display: none;"><div class="input-group"><label>ğŸ—ï¸ Ø§Ù„Ø´Ø±ÙƒØ©</label><input type="text" id="businessName"></div></div>
â€Â Â Â Â Â Â Â  <button class="btn-submit" onclick="saveAccount()">Ø­ÙØ¸ ÙˆØ¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø­Ø³Ø§Ø¨</button>
â€Â Â Â Â Â Â Â  <p id="saveMsg" style="color: var(--green); display: none;">âœ… ØªÙ… Ø§Ù„Ø­ÙØ¸ Ø¨Ù†Ø¬Ø§Ø­!</p>
â€Â Â Â  </div>
â€</div>
â€
â€<div id="adminOrdersView" class="view-section">
â€Â Â Â  <h3 style="border-right: 4px solid var(--accent); padding-right: 10px;">ğŸ“¥ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø²Ø¨Ø§Ø¦Ù† Ø§Ù„ÙˆØ§Ø±Ø¯Ø©</h3>
â€Â Â Â  <div id="ordersList"></div>
â€</div>
â€
â€<div class="bottom-nav">
â€Â Â Â  <div class="nav-item active" onclick="switchView('homeView', this)"><span>ğŸ </span>Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</div>
â€Â Â Â  <div class="nav-item" onclick="switchView('supplierView', this)"><span>âš™ï¸</span>Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</div>
â€Â Â Â  <div class="nav-item" onclick="switchView('adminOrdersView', this)"><span>ğŸ“‹</span>Ø§Ù„Ø·Ù„Ø¨Ø§Øª</div>
â€Â Â Â  <div class="nav-item" onclick="switchView('authView', this)"><span>ğŸ‘¤</span>Ø­Ø³Ø§Ø¨ÙŠ</div>
â€</div>
â€
â€<script>
â€Â Â Â  // ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ù„Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Ø³ÙŠØ±ÙØ± Ø¢Ø³ÙŠØ§) Ù„Ø¶Ù…Ø§Ù† Ø§Ù„ØªØ·Ø§Ø¨Ù‚ Ø§Ù„ØªØ§Ù…
â€Â Â Â  const firebaseConfig = {
â€Â Â Â Â Â Â Â  apiKey: "AIzaSyA6PC-y6wO1Lv8Hjgi...", 
â€Â Â Â Â Â Â Â  authDomain: "hussain-e8703.firebaseapp.com",
â€Â Â Â Â Â Â Â  databaseURL: "https://hussain-e8703-default-rtdb.asia-southeast1.firebasedatabase.app/",
â€Â Â Â Â Â Â Â  projectId: "hussain-e8703",
â€Â Â Â Â Â Â Â  storageBucket: "hussain-e8703.appspot.com",
â€Â Â Â Â Â Â Â  messagingSenderId: "1071985338140",
â€Â Â Â Â Â Â Â  appId: "1:1071985338140:web:968f86f76527b140da662e"
â€Â Â Â  };
â€
â€Â Â Â  firebase.initializeApp(firebaseConfig);
â€Â Â Â  const db = firebase.database();
â€
â€Â Â Â  let state = {
â€Â Â Â Â Â Â Â  products: [],
â€Â Â Â Â Â Â Â  orders: [],
â€Â Â Â Â Â Â Â  account: JSON.parse(localStorage.getItem('m_account')) || { role: 'customer' },
â€Â Â Â Â Â Â Â  tempImg: "",
â€Â Â Â Â Â Â Â  currentFilter: 'Ø§Ù„ÙƒÙ„'
â€Â Â Â  };
â€
â€Â Â Â  // Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
â€Â Â Â  db.ref('products').on('value', (s) => {
â€Â Â Â Â Â Â Â  const val = s.val();
â€Â Â Â Â Â Â Â  state.products = val ? Object.keys(val).map(key => ({...val[key], id: key})) : [];
â€Â Â Â Â Â Â Â  render(state.currentFilter);
â€Â Â Â  });
â€
â€Â Â Â  // Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª
â€Â Â Â  db.ref('orders').on('value', (s) => {
â€Â Â Â Â Â Â Â  const val = s.val();
â€Â Â Â Â Â Â Â  state.orders = val ? Object.keys(val).map(key => ({...val[key], id: key})) : [];
â€Â Â Â Â Â Â Â  renderOrders();
â€Â Â Â  });
â€
â€Â Â Â  function previewAndResizeImage(input) {
â€Â Â Â Â Â Â Â  if (input.files && input.files[0]) {
â€Â Â Â Â Â Â Â Â Â Â Â  let r = new FileReader();
â€Â Â Â Â Â Â Â Â Â Â Â  r.onload = e => {
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  let img = new Image();
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  img.onload = function() {
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  let canvas = document.createElement('canvas');
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  let maxW = 400; 
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  let scale = maxW / img.width;
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  canvas.width = maxW;
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  canvas.height = img.height * scale;
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  let ctx = canvas.getContext("2d");
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  state.tempImg = canvas.toDataURL("image/jpeg", 0.5); 
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  document.getElementById('imagePreview').src = state.tempImg;
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  document.getElementById('imagePreview').style.display = "block";
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  };
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  img.src = e.target.result;
â€Â Â Â Â Â Â Â Â Â Â Â  };
â€Â Â Â Â Â Â Â Â Â Â Â  r.readAsDataURL(input.files[0]);
â€Â Â Â Â Â Â Â  }
â€Â Â Â  }
â€
â€Â Â Â  function addProduct() {
â€Â Â Â Â Â Â Â  const n = document.getElementById('pName').value, 
â€Â Â Â Â Â Â Â Â Â Â Â Â Â  p = document.getElementById('pPrice').value, 
â€Â Â Â Â Â Â Â Â Â Â Â Â Â  c = document.getElementById('pCat').value;
â€Â Â Â Â Â Â Â  const btn = document.getElementById('submitBtn');
â€
â€Â Â Â Â Â Â Â  if(n && p) {
â€Â Â Â Â Â Â Â Â Â Â Â  btn.disabled = true; btn.innerText = "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù†Ø´Ø±...";
â€Â Â Â Â Â Â Â Â Â Â Â  const newPostKey = db.ref().child('products').push().key;
â€Â Â Â Â Â Â Â Â Â Â Â  const finalImg = state.tempImg || "https://via.placeholder.com/300x200?text=No+Image";
â€Â Â Â Â Â Â Â Â Â Â Â  
â€Â Â Â Â Â Â Â Â Â Â Â  db.ref('products/' + newPostKey).set({
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  id: newPostKey, name:n, price:Number(p), cat:c, img:finalImg
â€Â Â Â Â Â Â Â Â Â Â Â  })
â€Â Â Â Â Â Â Â Â Â Â Â  .then(() => {
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  alert("âœ… ØªÙ… Ø§Ù„Ù†Ø´Ø± Ø¨Ù†Ø¬Ø§Ø­!");
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  document.getElementById('pName').value = ""; 
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  document.getElementById('pPrice').value = "";
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  document.getElementById('imagePreview').style.display="none"; 
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  state.tempImg="";
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  btn.disabled = false; btn.innerText = "Ù†Ø´Ø± ÙÙŠ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø¹Ø±Ø§Ù‚ÙŠ";
â€Â Â Â Â Â Â Â Â Â Â Â  })
â€Â Â Â Â Â Â Â Â Â Â Â  .catch(err => {
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  alert("âŒ ÙØ´Ù„: " + err.message);
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  btn.disabled = false; btn.innerText = "Ù†Ø´Ø± ÙÙŠ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø¹Ø±Ø§Ù‚ÙŠ";
â€Â Â Â Â Â Â Â Â Â Â Â  });
â€Â Â Â Â Â Â Â  } else {
â€Â Â Â Â Â Â Â Â Â Â Â  alert("âš ï¸ ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„Ø³Ø¹Ø±");
â€Â Â Â Â Â Â Â  }
â€Â Â Â  }
â€
â€Â Â Â  function order(id) {
â€Â Â Â Â Â Â Â  const p = state.products.find(x => x.id == id);
â€Â Â Â Â Â Â Â  const ph = prompt("Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ù‡Ø§ØªÙÙƒ Ù„ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨:", state.account.phone || "");
â€Â Â Â Â Â Â Â  if(ph) {
â€Â Â Â Â Â Â Â Â Â Â Â  const ordId = db.ref().child('orders').push().key;
â€Â Â Â Â Â Â Â Â Â Â Â  db.ref('orders/' + ordId).set({
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  id: ordId, pName: p.name, phone: ph, time: new Date().toLocaleString(), status: 'Ø¬Ø¯ÙŠØ¯'
â€Â Â Â Â Â Â Â Â Â Â Â  }).then(() => alert("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨Ùƒ Ù„Ù„Ù…ÙˆØ±Ø¯!"));
â€Â Â Â Â Â Â Â  }
â€Â Â Â  }
â€
â€Â Â Â  function del(id) { 
â€Â Â Â Â Â Â Â  if(confirm("Ø­Ø°Ù Ø§Ù„Ù…Ø§Ø¯Ø©ØŸ")) {
â€Â Â Â Â Â Â Â Â Â Â Â  db.ref('products/' + id).remove();
â€Â Â Â Â Â Â Â  }
â€Â Â Â  }
â€
â€Â Â Â  function saveAccount() {
â€Â Â Â Â Â Â Â  state.account = {
â€Â Â Â Â Â Â Â Â Â Â Â  role: state.account.role,
â€Â Â Â Â Â Â Â Â Â Â Â  name: document.getElementById('userName').value,
â€Â Â Â Â Â Â Â Â Â Â Â  phone: document.getElementById('userPhone').value,
â€Â Â Â Â Â Â Â Â Â Â Â  city: document.getElementById('userCity').value,
â€Â Â Â Â Â Â Â Â Â Â Â  addr: document.getElementById('userAddress').value,
â€Â Â Â Â Â Â Â Â Â Â Â  bName: document.getElementById('businessName').value
â€Â Â Â Â Â Â Â  };
â€Â Â Â Â Â Â Â  localStorage.setItem('m_account', JSON.stringify(state.account));
â€Â Â Â Â Â Â Â  db.ref('users/' + state.account.phone).set(state.account);
â€Â Â Â Â Â Â Â  document.getElementById('saveMsg').style.display = 'block';
â€Â Â Â Â Â Â Â  setTimeout(() => document.getElementById('saveMsg').style.display = 'none', 3000);
â€Â Â Â  }
â€
â€Â Â Â  function render(filter = 'Ø§Ù„ÙƒÙ„') {
â€Â Â Â Â Â Â Â  state.currentFilter = filter;
â€Â Â Â Â Â Â Â  const filtered = filter === 'Ø§Ù„ÙƒÙ„' ? state.products : state.products.filter(p => p.cat === filter);
â€Â Â Â Â Â Â Â  
â€Â Â Â Â Â Â Â  const cardHtml = (p, adm) => `
â€Â Â Â Â Â Â Â Â Â Â Â  <div class="card">
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  ${adm ? `<button class="delete-btn" onclick="del('${p.id}')">Ø­Ø°Ù</button>` : ''}
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  <img src="${p.img}">
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  <div class="card-body">
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  <div class="p-name">${p.name}</div>
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  <span class="p-price-num">${Number(p.price).toLocaleString()} Ø¯.Ø¹</span>
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  ${!adm ? `<button class="btn-submit" style="padding:8px; font-size:12px; margin-top:5px" onclick="order('${p.id}')">Ø§Ø·Ù„Ø¨</button>` : ''}
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  </div>
â€Â Â Â Â Â Â Â Â Â Â Â  </div>`;
â€
â€Â Â Â Â Â Â Â  document.getElementById('mainGrid').innerHTML = filtered.map(p => cardHtml(p, false)).join('');
â€Â Â Â Â Â Â Â  document.getElementById('adminGrid').innerHTML = state.products.map(p => cardHtml(p, true)).join('');
â€Â Â Â  }
â€
â€Â Â Â  function renderOrders() {
â€Â Â Â Â Â Â Â  document.getElementById('ordersList').innerHTML = state.orders.map(o => `
â€Â Â Â Â Â Â Â Â Â Â Â  <div style="background:white; padding:15px; border-radius:12px; margin-bottom:10px; border-right:5px solid var(--accent); box-shadow: var(--shadow);">
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  <b>ğŸ“¦ ${o.pName}</b><br><small>ğŸ“± ${o.phone} | â° ${o.time}</small>
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  <div style="margin-top:10px">
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  <a href="tel:${o.phone}" style="color:green; text-decoration:none; font-weight:bold; font-size:14px;">ğŸ“ Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø²Ø¨ÙˆÙ†</a>
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  </div>
â€Â Â Â Â Â Â Â Â Â Â Â  </div>`).join('');
â€Â Â Â  }
â€
â€Â Â Â  function switchView(id, btn) {
â€Â Â Â Â Â Â Â  document.querySelectorAll('.view-section').forEach(v => v.classList.remove('active'));
â€Â Â Â Â Â Â Â  document.getElementById(id).classList.add('active');
â€Â Â Â Â Â Â Â  document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
â€Â Â Â Â Â Â Â  btn.classList.add('active');
â€Â Â Â Â Â Â Â  window.scrollTo(0, 0); // Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ø£Ø¹Ù„Ù‰ Ø§Ù„ØµÙØ­Ø© Ø¹Ù†Ø¯ Ø§Ù„ØªÙ†Ù‚Ù„
â€Â Â Â  }
â€
â€Â Â Â  function filterData(c, b) {
â€Â Â Â Â Â Â Â  document.querySelectorAll('.tab-btn').forEach(t => t.classList.remove('active'));
â€Â Â Â Â Â Â Â  b.classList.add('active');
â€Â Â Â Â Â Â Â  render(c);
â€Â Â Â  }
â€
â€Â Â Â  function setRole(r, b) { 
â€Â Â Â Â Â Â Â  state.account.role = r; 
â€Â Â Â Â Â Â Â  document.querySelectorAll('.role-btn').forEach(x => x.classList.remove('active'));
â€Â Â Â Â Â Â Â  b.classList.add('active');
â€Â Â Â Â Â Â Â  document.getElementById('businessDetails').style.display = (r === 'customer') ? 'none' : 'block';
â€Â Â Â  }
â€
â€Â Â Â  window.onload = function() {
â€Â Â Â Â Â Â Â  const acc = state.account;
â€Â Â Â Â Â Â Â  if(acc && acc.name) {
â€Â Â Â Â Â Â Â Â Â Â Â  document.getElementById('userName').value = acc.name || "";
â€Â Â Â Â Â Â Â Â Â Â Â  document.getElementById('userPhone').value = acc.phone || "";
â€Â Â Â Â Â Â Â Â Â Â Â  document.getElementById('userCity').value = acc.city || "Ø¨ØºØ¯Ø§Ø¯";
â€Â Â Â Â Â Â Â Â Â Â Â  document.getElementById('userAddress').value = acc.addr || "";
â€Â Â Â Â Â Â Â Â Â Â Â  document.getElementById('businessName').value = acc.bName || "";
â€Â Â Â Â Â Â Â Â Â Â Â  if(acc.role) {
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  const roleBtn = document.getElementById('role-' + acc.role);
â€Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  if(roleBtn) setRole(acc.role, roleBtn);
â€Â Â Â Â Â Â Â Â Â Â Â  }
â€Â Â Â Â Â Â Â  }
â€Â Â Â Â Â Â Â  render();
â€Â Â Â  };
â€</script>
â€</body>
â€</html>
â€
